# Система обучения

Полноценная система управления обучением с админ-панелью и личными кабинетами.

## Структура проекта

```
HAKATON/
├── backend/          # Node.js + Express + PostgreSQL
│   ├── config/       # Конфигурация БД
│   ├── models/       # Модели данных
│   ├── routes/       # API маршруты
│   ├── middleware/   # Middleware (аутентификация)
│   └── server.js     # Точка входа сервера
│
└── frontend/         # React + Vite
    ├── src/
    │   ├── components/   # Компоненты (AdminLayout, UsersManagement)
    │   ├── context/      # Context API (AuthContext)
    │   ├── pages/        # Страницы (Login, AdminDashboard, StudentDashboard)
    │   ├── utils/        # Утилиты (API клиент)
    │   └── App.jsx       # Главный компонент
    └── package.json
```

## Установка и запуск

### 1. Установка PostgreSQL

Если PostgreSQL еще не установлен:
1. Скачайте с https://www.postgresql.org/download/
2. Установите с настройками по умолчанию
3. Запомните пароль для пользователя `postgres`

### 2. Создание базы данных

Откройте pgAdmin или используйте командную строку:

```sql
CREATE DATABASE hakaton_db;
```

### 3. Запуск Backend

```powershell
cd backend
npm install
```

Отредактируйте `.env` файл и укажите свои данные для PostgreSQL:
```
DB_PASSWORD=ваш_пароль
```

Запустите сервер:
```powershell
npm run dev
```

Сервер запустится на http://localhost:5000

### 4. Запуск Frontend

Откройте новый терминал:

```powershell
cd frontend
npm install
npm run dev
```

Приложение откроется на http://localhost:3000

## Создание первого администратора

После запуска backend, база данных создастся автоматически. Для создания первого администратора выполните SQL запрос в pgAdmin:

```sql
INSERT INTO users (username, email, password, role, full_name) 
VALUES (
  'admin',
  'admin@example.com',
  '$2a$10$YourHashedPasswordHere',
  'admin',
  'Администратор'
);
```

Или используйте этот готовый запрос (пароль: `admin123`):
```sql
INSERT INTO users (username, email, password, role, full_name) 
VALUES (
  'admin',
  'admin@example.com',
  '$2a$10$8Jg8/0HZEQqHxqYCJ5VqVuqYqYQ5K5y8KhXhxJ3QZ4Z5Y0Y5Y0Y5Y',
  'admin',
  'Администратор'
);
```

## Использование

### Вход в систему

1. Откройте http://localhost:3000
2. Введите учетные данные администратора:
   - Email: `admin@example.com`
   - Пароль: `admin123`

### Админ-панель

После входа как администратор вы попадете в админ-панель где можете:

#### Управление пользователями
- Создавать новых пользователей (учеников и администраторов)
- Редактировать пользователей
- Удалять пользователей
- Видеть к какой группе принадлежит каждый ученик

#### Управление группами
- Создавать новые группы
- Редактировать название и описание групп
- Удалять группы
- Добавлять студентов в группы
- Удалять студентов из групп
- Видеть количество студентов в каждой группе

### Личный кабинет ученика

1. Создайте ученика через админ-панель
2. Создайте группу и добавьте ученика в группу
3. Выйдите из системы
4. Войдите используя данные созданного ученика
5. В личном кабинете ученик увидит:
   - Свою информацию о профиле
   - Информацию о своей группе (если назначена)
   - Количество студентов в группе
   - Описание группы

## Архитектура для расширения

### Добавление новой страницы в админ-панель

1. Создайте новый компонент в `frontend/src/components/`
2. Добавьте маршрут в `frontend/src/pages/AdminDashboard.jsx`
3. Добавьте пункт меню в `frontend/src/components/AdminLayout.jsx`

### Добавление нового API endpoint

1. Создайте новый роутер в `backend/routes/`
2. Подключите его в `backend/server.js`
3. При необходимости создайте новую модель в `backend/models/`

### Добавление новой функциональности в ЛК ученика

Редактируйте `frontend/src/pages/StudentDashboard.jsx` и добавляйте новые карточки или секции.

## API Endpoints

### Авторизация
- `POST /api/auth/login` - Вход в систему
- `GET /api/auth/me` - Получить данные текущего пользователя
- `POST /api/auth/logout` - Выход

### Управление пользователями (только для админов)
- `GET /api/users` - Получить всех пользователей
- `POST /api/users` - Создать пользователя
- `GET /api/users/:id` - Получить пользователя по ID
- `PUT /api/users/:id` - Обновить пользователя
- `DELETE /api/users/:id` - Удалить пользователя

### Управление группами (только для админов)
- `GET /api/groups` - Получить все группы с количеством студентов
- `POST /api/groups` - Создать новую группу
- `GET /api/groups/:id` - Получить группу с полным списком студентов
- `PUT /api/groups/:id` - Обновить группу
- `DELETE /api/groups/:id` - Удалить группу
- `POST /api/groups/:id/students` - Добавить студентов в группу
- `DELETE /api/groups/:groupId/students/:studentId` - Удалить студента из группы
- `GET /api/groups/students/available` - Получить студентов без группы

## Технологии

### Backend
- Node.js
- Express.js
- PostgreSQL
- JWT для аутентификации
- bcryptjs для хеширования паролей

### Frontend
- React 18
- Vite
- React Router v6
- Context API для управления состоянием
- Чистый CSS

## Безопасность

- Пароли хешируются с помощью bcrypt
- JWT токены для аутентификации
- Middleware для проверки ролей
- Защита от SQL инъекций через параметризованные запросы

## База данных

### Таблицы

#### users
- `id` - уникальный идентификатор
- `username` - имя пользователя (уникальное)
- `email` - email (уникальный)
- `password` - хешированный пароль
- `role` - роль (admin/student)
- `full_name` - полное имя
- `group_id` - ID группы (внешний ключ)
- `created_at` - дата создания
- `updated_at` - дата обновления

#### groups
- `id` - уникальный идентификатор
- `name` - название группы
- `description` - описание группы
- `created_at` - дата создания
- `updated_at` - дата обновления

### Связи
- Один ко многим: `groups` -> `users` (одна группа может содержать много студентов)
- При удалении группы, студенты не удаляются, только связь (group_id устанавливается в NULL)

## Дальнейшее развитие

Готовая архитектура позволяет легко добавлять:
- Новые страницы в админ-панели и ЛК
- Новые роли пользователей
- Дополнительные таблицы в БД (курсы, задания, тесты)
- Новые API endpoints
- Связь групп с курсами
- Систему уведомлений
- Чат внутри групп
- Файловое хранилище для материалов
