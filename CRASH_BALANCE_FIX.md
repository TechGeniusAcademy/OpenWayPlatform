# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –±–∞–ª–∞–Ω—Å–æ–º –≤ Crash Game

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

### 1. Frontend (CrashGame.jsx)

‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞:**
- –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –≤—ã–≤–æ–¥–∏—Ç—Å—è –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞:**
- –ë–∞–ª–∞–Ω—Å —Ç–µ–ø–µ—Ä—å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ü–ï–†–ï–î —Å—Ç–∞–≤–∫–æ–π (async/await)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–µ—Ç–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Å —Ç–µ–∫—É—â–∏–º –±–∞–ª–∞–Ω—Å–æ–º

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ userId:**
- userId –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤ —á–∏—Å–ª–æ: `parseInt(localStorage.getItem('userId'))`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è userId –∏ token
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

‚úÖ **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö —Å—Ç–∞–≤–∫–∏ –∏ –∫–µ—à–∞—É—Ç–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π –≤ –∫–æ–Ω—Å–æ–ª—å

### 2. Backend (server.js)

‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ `socket.userId` –ø–µ—Ä–µ–¥ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ–º —Å—Ç–∞–≤–∫–∏
- –ü–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω"

‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –í—ã–≤–æ–¥–∏—Ç—Å—è socket.id –∏ userId –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å—Ç–∞–≤–∫–∏
- –ü–æ–º–æ–≥–∞–µ—Ç –æ—Ç—Å–ª–µ–¥–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π

### 3. Backend (CrashGame.js –º–æ–¥–µ–ª—å)

‚úÖ **–£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –í—ã–≤–æ–¥–∏—Ç—Å—è –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–µ—Ä–µ–¥ —Å—Ç–∞–≤–∫–æ–π
- –í—ã–≤–æ–¥–∏—Ç—Å—è —Å—É–º–º–∞ —Å—Ç–∞–≤–∫–∏
- –î–µ—Ç–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏–º–µ—é—â–µ–≥–æ—Å—è –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞

‚úÖ **–†–∞–∑–¥–µ–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞:**
- –û—Ç–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û—Ç–¥–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º

---

## üêõ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–µ —Å –±–∞–ª–∞–Ω—Å–æ–º –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏:

### Frontend Console:
```
[CRASH] Connecting with userId: 5
[CRASH] Connected to Crash game, socket ID: xyz123
[CRASH] Registering with userId: 5
Fetched user data: {id: 5, username: "...", points: 1500}
User balance: 1500
Current balance before bet: 1500
Bet amount: 100
[CRASH] Bet placed successfully: {id: 1, bet_amount: 100, ...}
```

### Backend Console:
```
üîî –ü–æ–ª—É—á–µ–Ω –∑–∞–ø—Ä–æ—Å register –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 5, socket: xyz123
‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 5 –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –∏ –æ–Ω–ª–∞–π–Ω
[CRASH] Place bet request from socket xyz123, userId: 5
[CRASH] User 5 balance: 1500
[CRASH] Bet amount: 100
[CRASH] Bet placed successfully for user 5
üí∞ –°—Ç–∞–≤–∫–∞ 100 –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 5 –≤ –∏–≥—Ä–µ 1
```

---

## üöÄ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend:**
   ```bash
   cd backend
   npm run dev
   ```

2. **–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É frontend** (Ctrl+F5)

3. **–û—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞** (F12)

4. **–ó–∞–π—Ç–∏ –≤ Crash Game**

5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:**
   - –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å `[CRASH] Connecting with userId: X`
   - –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å `User balance: XXX`

6. **–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É**

7. **–ï—Å–ª–∏ –æ—à–∏–±–∫–∞:**
   - –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
   - –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –∫–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞
   - –°–æ–æ–±—â–∏—Ç—å —Ç–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏

---

## üîç –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è:

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω"
**–†–µ—à–µ–Ω–∏–µ:** 
- –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—ã –∑–∞–ª–æ–≥–∏–Ω–µ–Ω—ã
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å localStorage: –µ—Å—Ç—å –ª–∏ —Ç–∞–º `userId` –∏ `token`

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "User not found"
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ userId –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤ –ë–î
- –í—ã–ø–æ–ª–Ω–∏—Ç—å: `SELECT id, username, points FROM users WHERE id = X;`

### –ü—Ä–æ–±–ª–µ–º–∞ 3: "Insufficient balance: has 0, needs 100"
**–†–µ—à–µ–Ω–∏–µ:**
- –ë–∞–ª–∞–Ω—Å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ 0
- –î–æ–±–∞–≤–∏—Ç—å –±–∞–ª–ª—ã —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É –∏–ª–∏ SQL:
  ```sql
  UPDATE users SET points = 1000 WHERE id = X;
  ```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ë–∞–ª–∞–Ω—Å –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ
**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ `/api/users/me` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ Network –≤–∫–ª–∞–¥–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞
- –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É

---

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å –≤ –ë–î:
```sql
SELECT id, username, points FROM users WHERE id = YOUR_USER_ID;
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞–≤–∫–∏:
```sql
SELECT * FROM crash_bets WHERE user_id = YOUR_USER_ID ORDER BY created_at DESC LIMIT 5;
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â—É—é –∏–≥—Ä—É:
```sql
SELECT * FROM crash_games WHERE status IN ('waiting', 'running') ORDER BY created_at DESC LIMIT 1;
```

---

## ‚úÖ Checklist –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

- [ ] Backend –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω
- [ ] Frontend –æ–±–Ω–æ–≤–ª–µ–Ω (Ctrl+F5)
- [ ] –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –≤–∏–¥–Ω–æ –ª–æ–≥–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- [ ] –í –∫–æ–Ω—Å–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞ –≤–∏–¥–Ω–æ –ª–æ–≥–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- [ ] –ë–∞–ª–∞–Ω—Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- [ ] –°—Ç–∞–≤–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ
- [ ] –ë–∞–ª–∞–Ω—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ —Å—Ç–∞–≤–∫–∏

---

*–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–µ–Ω–∞, –ø—Ä–∏—à–ª–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –ò –∫–æ–Ω—Å–æ–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞.*
